# Описание работы бота 

## Оглавление

0. [Вводное описание](#Вводное-описание)
1. [API](#API)
2. [Интерфейс бота](#Интерфейс-бота)
    1. [Начало работы](#Начало-работы)
    2. [Помощь](#Помощь)
    3. [Обучение](#Обучение)
    4. [Обученные модели](#Обученные-модели)
    5. [Прогноз](#Прогноз)
    6. [Просмотр результатов](#Просмотр-результатов)
    7. [Удаление модели](#Удаление-модели)
    8. [Дополнительная информация](#Дополнительная-информация)
3. [Контакты](#Контакты)
    
## Вводное описание

В данном репозитории представлена работа телеграм-ботом [@make_ml_great_again_bot](https://t.me/make_ml_great_again_bot). Бот работаем с дефолтным датасетом sklearn iris [ссылка на документацию](https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_iris.html). Для предсказания новых значений Бот предлагает на выбор две модели [LogReg](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html?highlight=logistic#sklearn.linear_model.LogisticRegression) и [Decision Tree](https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html?highlight=decision%20tree#sklearn.tree.DecisionTreeClassifier) с возможностью выбирать гиперпараметры из ограниченного списка. В репозитории хранятся файлы, обеспечивающие работу бота; запуск API, помощью которого бот забирает, обновляет, удаляет данные; файл для логгирования действий и файл к даными подключения.


## API

API реализовано помощью 6 ручек:


1. **'/api/ml_models'**
    + метод GET показывает реализованные классы моделей и их гиперпараметры
2. **'/api/ml_models/trained_models'**
    + метод GET показывает обученные модели и их гиперпараметры
3. **'/api/ml_models/results'**
    + метод GET показывает результаты прогнозов на обученных моделях
4. **'/api/ml_models/<int:id>/train'**
    + метод PUT обучает модели с id соответсвующего класса
5. **'/api/ml_models/<int:id>/predict'**
    + метод POST выдаёт прогноз модели с id соответсвующего класса
6. **'/api/ml_models/<int:id>/delete'**
    + метод DELETE удаляется модель с id соответсвующего класса

## Интерфейс бота

#### Начало работы
Как и многие другие боты старт работы начинается с:
```
/start
```
Бот был проектирован с высокими значениями вежливости, поэтому он сначала поприветствует пользователя, а затем расскажет как он работает:
```
Привет, Sava! Я бот, который предсказывает тип ирисов по вашим данным. Чтобы узнать, что я умею нажмите /help
```
-----------
#### Помощь
Бот предлагает посмотреть, какие метод можно осуществить в его работе:
```
/help
```
На выходе получаем список методов:
```
Информационная справка по методам бота:

        1. /start - приветствие
        
        2. /help - информация по методам
        
        3. /models - классы возможных моделей для обучения
        
        4. /train - обучение новой модели

        5. /trained_models - каталог обученных модели
        
        5. /predict - прогноз на обученных моделях
        
        6. /delete - удаление модели
        
        7. /show_results - результаты прогнозов
```
-----------
#### Обучение
Дальше предлагается обучить новую модель:
```
/train
```
Бот предлагает нам выбрать класс модели:
```
Для начала выберите модель, которую вы хотите обучить. Ниже напишите одно число: 1 - LogReg, 2 - Decision Tree
```
Например, нас интересует LogReg - вводим 1:
```
1
```
Бот попросит вас ввести необходимые гиперпараметры:
```
Вы выбрали модель LR.
Теперь введите гиперпараметры модели в формате:

{'max_iter': 'int', 'penalty': ['l1', 'l2'], 'C': 'float'}
```
Введём, например, следующие гиперпараметры:
```
{'max_iter': 2, 'penalty': 'l2', 'C': 0.1}
```
Бот обучает и сохраняет модель:
```
Для модели LR были выбраны следующие гиперпараметры: {'max_iter': 2, 'penalty': 'l2', 'C': 0.1}
Модель с ID = 1 обучена и сохранена под номером 1
```
-----------
#### Обученные модели
Посмотрим сохранилась ли, обученная модель:
```
/trained_models
```
Бот действительно выводит обученные модели:
```
Модели LR:
   №1:  {'C': 0.1, 'max_iter': 2, 'penalty': 'l2'}


Модели DT:
```
-----------
#### Прогноз
Теперь сделаем прогноз на модели из каталога обученных моделей:
```
/predict
```
Бот попросит вас выбрать модель и ввести данные для прогноза:
(формат данных id num x1 x2 x3 x4; первые два числа целые и больше нуля обозначают класс и номер модели, остальные 4 положительных вещественных числа - вводные данные датасета [подробнее в официальной документации](https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_iris.html)))
```
Выберите обученную модель и отправьте данные для прогноза.
Формат (через пробел):
ID (номер класса) num (номер модели) X (1 2 3 4 данные для прогноза, 4 положительных рациональных числа)

Пример:
1 1 0.5 0.5 0.5 0.5
```
Воспользуемся предложенным примером:
```
1 1 0.5 0.5 0.5 0.5
```
Получаем результат:
```
Результат прогноза: [2]
```
-----------
#### Просмотр результатов
Можно проверить сохранился ли результат в данных:
```
/show_results
```
Действительно, результат осталcя:
```
Модели LR:
   №1:  Данные  0.5 0.5 0.5 0.5, Прогноз [2]


Модели DT:

```
-----------
#### Удаление модели
Теперь поробуем удалить модель:
```
/delete
```
Бот предлагает выбрать, какую модель вы хотите удалить:
```
Выберите модель для удаления.
Формат:
ID номер модели 

Пример:
1 1
```
Воспользуемся примером (к тому же эта модель у нас есть):
```
1 1
```
Получаем ответ:
```
Данные модели класса 1 номера 1 были удалены
```
Теперь можем проверить удалились ли данные из каталога моеделей и результатов прогнозов.
Если всё верно, то \trained_models покажет:
```
Модели LR:
   №1:  None


Модели DT:
```
А \show_results выдаст:
```
Модели LR:
   №1:  Данные  None, Прогноз None


Модели DT:

```
-----------
#### Дополнительная информация
В боте учтены возможные ошибки пользователя при отправлении запросов. Подробнее про них можно учточнить в контактах или проверить код 'bot.py'
## Контакты
При возникновении любых вопросов общайтесь в [@savababin](https://t.me/make_ml_great_again_bot/savababin)

